<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Background · WaterWaves1D.jl</title><meta name="title" content="Background · WaterWaves1D.jl"/><meta property="og:title" content="Background · WaterWaves1D.jl"/><meta property="twitter:title" content="Background · WaterWaves1D.jl"/><meta name="description" content="Documentation for WaterWaves1D.jl."/><meta property="og:description" content="Documentation for WaterWaves1D.jl."/><meta property="twitter:description" content="Documentation for WaterWaves1D.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="WaterWaves1D.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">WaterWaves1D.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Background</a><ul class="internal"><li><a class="tocitem" href="#Water-waves"><span>Water waves</span></a></li><li><a class="tocitem" href="#Models"><span>Models</span></a></li><li><a class="tocitem" href="#Mass,-momentum,-energy"><span>Mass, momentum, energy</span></a></li><li><a class="tocitem" href="#Pseudospectral-methods"><span>Pseudospectral methods</span></a></li></ul></li><li><a class="tocitem" href="../problems/">Problems</a></li><li><a class="tocitem" href="../how-to/">How-to...</a></li><li><a class="tocitem" href="../example/">Example</a></li><li><a class="tocitem" href="../plot_recipes/">Plot recipes</a></li><li><a class="tocitem" href="../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Background</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Background</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/WaterWavesModels/WaterWaves1D.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/WaterWavesModels/WaterWaves1D.jl/blob/master/docs/src/background.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Background"><a class="docs-heading-anchor" href="#Background">Background</a><a id="Background-1"></a><a class="docs-heading-anchor-permalink" href="#Background" title="Permalink"></a></h1><ul><li><a href="#Background">Background</a></li><li class="no-marker"><ul><li><a href="#Water-waves">Water waves</a></li><li><a href="#Models">Models</a></li><li class="no-marker"><ul><li><a href="#Shallow-water-models">Shallow water models</a></li><li class="no-marker"><ul><li><a href="#The-Saint-Venant-system">The Saint-Venant system</a></li><li><a href="#The-Boussinesq-systems">The Boussinesq systems</a></li><li><a href="#The-Whitham-Boussinesq-systems">The Whitham-Boussinesq systems</a></li><li><a href="#The-Green-Naghdi-system">The Green-Naghdi system</a></li><li><a href="#The-square-root-depth-system">The square-root depth system</a></li><li><a href="#The-&quot;non-hydrostatic&quot;-system">The &quot;non-hydrostatic&quot; system</a></li><li><a href="#The-Whitham-Green-Naghdi-system">The Whitham-Green-Naghdi system</a></li><li><a href="#The-Isobe-Kakinuma-systems">The Isobe-Kakinuma systems</a></li></ul></li><li><a href="#Small-steepness-models">Small steepness models</a></li><li class="no-marker"><ul><li><a href="#The-Airy-equations">The Airy equations</a></li><li><a href="#The-spectral-systems">The spectral systems</a></li><li><a href="#The-rectified-spectral-systems">The rectified spectral systems</a></li><li><a href="#The-Matsuno-system">The Matsuno system</a></li><li><a href="#The-modified-Matsuno-system">The modified Matsuno system</a></li><li><a href="#The-Akers-Nicholls-system">The Akers-Nicholls system</a></li></ul></li></ul></li><li><a href="#Mass,-momentum,-energy">Mass, momentum, energy</a></li><li><a href="#Pseudospectral-methods">Pseudospectral methods</a></li></ul></li></ul><h2 id="Water-waves"><a class="docs-heading-anchor" href="#Water-waves">Water waves</a><a id="Water-waves-1"></a><a class="docs-heading-anchor-permalink" href="#Water-waves" title="Permalink"></a></h2><p>The propagation of waves at the surface of a layer of water is typically modelled using the incompressible Euler equations inside the fluid domain, and suitable boundary conditions at the boundaries (accounting for the impermeable bottom and the free surface).</p><p>In an idealized situation where the only external force acting on the fluid is due to the (constant) vertical gravity acceleration, that the fluid is <em>homogeneous</em> and the flow is <em>potential</em> (that is irrotational), the system can be written in closed form as two evolution equations.</p><p>Restricting to <em>unidimensional waves</em> (horizontal dimension <span>$d=1$</span>) in a domain without horizontal boundaries, assuming that the free surface can be described as the graph of a function which never touches the bottom (that is, non-cavitation) neglecting surface tension effects, assuming constant atmospheric pressure at the free surface and free slip boundary condition at the flat bottom, the equations in dimensionless variables read as follows (following notations in <a href="https://bookstore.ams.org/surv-188">Lannes</a>, <a href="https://www.ams.org/open-math-notes/omn-view-listing?listingId=111309">Duchêne</a>).</p><p class="math-container">\[  \left\{\begin{array}{l}
  ∂_tη-\tfrac{1}{μν} G^μ[ϵη]ψ=0,\\[1ex]
  ∂_tψ+η+\frac{ϵ}{2ν}(∂_xψ)^2-\tfrac{ϵμ}{2ν}\frac{(\frac{1}{μ} G^μ[ϵη]ψ+ϵ(∂_xη)(∂_xψ))^2}{1+μϵ²(∂_xη)^2}=0,
  \end{array}\right.\]</p><p>where, by definition,</p><p class="math-container">\[G^μ[ϵη]ψ=\big(∂_z\Phi-μϵ(∂_xη)(∂_xΦ)\big)\big\vert_{z=ϵη}\]</p><p>with <span>$Φ$</span> being the unique solution to the elliptic boundary value problem</p><p class="math-container">\[\left\{\begin{array}{ll}
μ ∂_x^2 Φ + ∂_z^2 Φ=0&amp; \text{ in } \{(x,z)\ : \  -1&lt;z&lt;ϵη(x)\} , \\
 Φ= ψ &amp; \text{ on } \{(x,z)\ : \  z=ϵη(x)\} ,\\
∂_z Φ=0 &amp; \text{ on } \{(x,z)\ : \  z=-1\} .
\end{array}\right.\]</p><p>In the above formula,</p><ul><li><span>$t,x,z$</span> represent respectively the (rescaled) time, horizontal and vertical space variables.</li><li><span>$η$</span> represents the <em>surface deformation</em>: the free surface may be parametrized as <span>$\{(x,z) :  z=ϵη(x)\}$</span>.</li><li><span>$ψ$</span> is the trace of the <em>velocity potential</em> at the surface. In models we generally prefer to use <span>$v=∂ₓψ$</span> as the second unknown, since <span>$ψ$</span> is not necessarily decaying at (spatial) infinity even in finite-energy situations.</li><li><span>$ϵ$</span> is the <em>nonlinearity</em> dimensionless parameter, defined as the ratio of the maximal amplitude of the wave to the depth of the layer.</li><li><span>$μ$</span> is the <em>shallowness</em> dimensionless parameter, defined as the square of the ratio of the depth of the layer to the typical horizontal wavelength of the flow.</li><li><span>$ν$</span> is a scaling parameter: in shallow water situations one typically sets <span>$ν=1$</span> while in deep water situations it is wise to set <span>$ν=1/\sqrt{μ}$</span>. In the latter case, <span>$ϵ\sqrt{μ}$</span> being the <em>steepness</em> of the wave plays an important role. Especially, taking formally the limit <span>$μ→∞$</span> one obtains the infinite-depth situation where the wave steepness is the only remaining parameter.</li></ul><p>While the above formulation (due to <a href="https://doi.org/10.1007/BF00913182">Zakharov</a> and <a href="https://doi.org/10.1006/jcph.1993.1164">Craig and Sulem</a>) is very elegant, it is not directly suitable for efficient numerical simulations, due to the costly time-dependent elliptic problem involved in the Dirichlet-to-Neumann operator, <span>$G^μ$</span>. In our unidimensional framework, it is possible to make use of conformal mapping so as to rewrite the system using only pointwise operations or Fourier multipliers (that is pointwise operations in Fourier space). This allows, by means of the <a href="https://en.wikipedia.org/wiki/Fast_Fourier_transform">Fast Fourier Transform</a> (FFT) and its inverse (IFFT), to provide a very efficient strategy for the numerical simulation of the water waves system. This strategy has been described for instance in <a href="https://doi.org/10.1016/0375-9601(96)00417-3">Dyachenko et al.</a> and <a href="https://doi.org/10.1061/(asce)0733-9399(1999)125:7(756)">Choi and Camassa</a>.</p><p>The resulting code is <a href="../library/#WaterWaves1D.WaterWaves"><code>WaterWaves</code></a>.</p><h2 id="Models"><a class="docs-heading-anchor" href="#Models">Models</a><a id="Models-1"></a><a class="docs-heading-anchor-permalink" href="#Models" title="Permalink"></a></h2><p>Because the above method is relatively recent (in comparison with early studies on water waves), imperfect (it suffers from &quot;anti-resolution&quot; for large-amplitude waves: the location of gridpoints spread out near wave crests, which in practice may demand the use of a very large number of modes to resolve the flow accurately), and restricted to unidimensional waves, many simplified models have been introduced in the literature. It is the aim of this package to provide a home for some of them.</p><h3 id="Shallow-water-models"><a class="docs-heading-anchor" href="#Shallow-water-models">Shallow water models</a><a id="Shallow-water-models-1"></a><a class="docs-heading-anchor-permalink" href="#Shallow-water-models" title="Permalink"></a></h3><p>Shallow water models are expected to provide valid approximation to the water waves system for small values of the shallowness parameter, <span>$μ≪1$</span> (in this case, <span>$ν=1$</span>).</p><p>Many of these models are derived and discussed in <a href="https://www.ams.org/open-math-notes/omn-view-listing?listingId=111309">Duchêne</a>.</p><h4 id="The-Saint-Venant-system"><a class="docs-heading-anchor" href="#The-Saint-Venant-system">The Saint-Venant system</a><a id="The-Saint-Venant-system-1"></a><a class="docs-heading-anchor-permalink" href="#The-Saint-Venant-system" title="Permalink"></a></h4><p>The <a href="https://en.wikipedia.org/wiki/Shallow_water_equations#One-dimensional_Saint-Venant_equations">Saint-Venant</a> system is one of the oldest model for the propagation of water waves. It reads</p><p class="math-container">\[  \left\{\begin{array}{l}
  ∂_tη+∂_x((1+ϵη)v)=0,\\[1ex]
  ∂_tv+∂_xη+ϵv∂_xv=0.
  \end{array}\right.\]</p><p>Notice that the parameter <span>$μ$</span> has disappeared: the Saint-Venant system is the order-zero shallow water model for water waves.</p><p>The associated code is <a href="../library/#WaterWaves1D.SaintVenant"><code>SaintVenant</code></a>.</p><h4 id="The-Boussinesq-systems"><a class="docs-heading-anchor" href="#The-Boussinesq-systems">The Boussinesq systems</a><a id="The-Boussinesq-systems-1"></a><a class="docs-heading-anchor-permalink" href="#The-Boussinesq-systems" title="Permalink"></a></h4><p>The <span>$abcd$</span>-<a href="https://en.wikipedia.org/wiki/Boussinesq_approximation_(water_waves)">Boussinesq</a> systems refers to the full class of equations described by <a href="https://doi.org/10.1007/s00332-002-0466-4">Bona, Chen and Saut</a></p><p class="math-container">\[  \left\{\begin{array}{l}
  ∂_tη+∂_x((1+ϵη)u)+a∂_x^3u-b∂_x^2∂_tη=0,\\[1ex]
  ∂_tu+∂_xη+ϵu∂_xu+c∂_x^3η-d∂_x^2∂_tu=0,
  \end{array}\right.\]</p><p>where <span>$a,b,c,d$</span> can be freely chosen as long as they satisfy <span>$a+b+c+d=1/3$</span>.</p><p>The associated code <a href="../library/#WaterWaves1D.Boussinesq"><code>Boussinesq</code></a> is restricted to the so-called Hamiltonian case, <span>$b=d$</span>, and <span>$c=0$</span>.</p><p>Indeed, in that case, one may genuinely interpret <span>$v=u-d∂_x^2u$</span> as an approximation to <span>$∂_xψ$</span>, the derivative of the trace of the velocity potential at the surface, and write the system as evolution equations for the variables <span>$(η,v)$</span>:</p><p class="math-container">\[  \left\{\begin{array}{l}
  ∂_tη+∂_x((1+a∂_x^2)(1-b∂_x^2)^{-2}v + ϵ(1-b∂_x^2)^{-1} (η (1-b∂_x^2)^{-1}v))=0,\\[1ex]
  ∂_tv+∂_xη+\tfrac{ϵ}{2}∂_x(((1-b∂_x^2)^{-1}v)^2) =0.
  \end{array}\right.\]</p><h4 id="The-Whitham-Boussinesq-systems"><a class="docs-heading-anchor" href="#The-Whitham-Boussinesq-systems">The Whitham-Boussinesq systems</a><a id="The-Whitham-Boussinesq-systems-1"></a><a class="docs-heading-anchor-permalink" href="#The-Whitham-Boussinesq-systems" title="Permalink"></a></h4><p>The Whitham-Boussinesq systems can be viewed as modified Boussinesq systems in view of fully recovering the <a href="https://en.wikipedia.org/wiki/Dispersion_(water_waves)">dispersive properties</a> of the water waves system. In other words, in the linear framework, that is setting <span>$ϵ=0$</span>, the model coincides with the linearized water waves system.</p><p>Specifically, we consider systems of the form</p><p class="math-container">\[  \left\{\begin{array}{l}
  ∂_tη+∂_x(F_1^μv + ϵ F_2^μ (η F_2^μv))=0,\\[1ex]
  ∂_tv+∂_xη+\tfrac{ϵ}{2}∂_x((F_2^μv)^2) =0,
  \end{array}\right.\]</p><p>with <span>$F_1^μ=\frac{\tanh(\sqrtμ D)}{\sqrtμ D}$</span>, and <span>$F_2^μ=(F_1^μ)^α$</span> (here we use the notation <span>$F(D)$</span> for the <a href="https://en.wikipedia.org/wiki/Multiplier_(Fourier_analysis)">action</a> of pointwise multiplying by the function <span>$F$</span> in the Fourier space). The case <span>$α = 1$</span> has been introduced by <a href="https://doi.org/10.1016/j.apnum.2018.09.016">Dinvay, Dutykh and Kalisch</a>, more general situations have been studied by <a href="https://doi.org/10.1137/20M1332049">Emerald</a>.</p><p>The associated code is <a href="../library/#WaterWaves1D.WhithamBoussinesq"><code>WhithamBoussinesq</code></a>.</p><h4 id="The-Green-Naghdi-system"><a class="docs-heading-anchor" href="#The-Green-Naghdi-system">The Green-Naghdi system</a><a id="The-Green-Naghdi-system-1"></a><a class="docs-heading-anchor-permalink" href="#The-Green-Naghdi-system" title="Permalink"></a></h4><p>The (Serre-)Green-Naghdi system (<a href="https://10.1051/lhb/1953058">Serre</a>, <a href="https://10.1063/1.1664873">Su and Gardner</a>, <a href="https://10.1017/s0022112076002425">Green and Naghdi</a>) is sometimes called &quot;fully nonlinear Boussinesq system&quot; and is expected to provide a better approximation when the parameter <span>$ϵ$</span> is large.</p><p>One of its many formulations is</p><p class="math-container">\[  \left\{\begin{array}{l}
  ∂_tη+∂_x\big( h u\big)=0,\\[1ex]
  ∂_tv+∂_x\big(η+ϵ uv - \tfrac{ϵ}{2}u^2-\tfrac{μϵ}2 (h∂_xu)^2\big) =0,
  \end{array}\right.\]</p><p>where <span>$h=1 + ϵ η$</span> is the depth, <span>$v=∂_xψ$</span> the derivative of the trace of the velocity potential at the surface, and <span>$u$</span> the layer-averaged horizontal velocity obtained by solving the elliptic problem</p><p class="math-container">\[ hu -\tfrac{μ}{3}∂_x( h^3 ∂_xu) = hv.\]</p><p>The associated code is <a href="../library/#WaterWaves1D.SerreGreenNaghdi"><code>SerreGreenNaghdi</code></a>.</p><h4 id="The-square-root-depth-system"><a class="docs-heading-anchor" href="#The-square-root-depth-system">The square-root depth system</a><a id="The-square-root-depth-system-1"></a><a class="docs-heading-anchor-permalink" href="#The-square-root-depth-system" title="Permalink"></a></h4><p>The &quot;√D&quot; system proposed by <a href="https://doi.org/10.1098/rspa.2010.0124">Cotter, Holm and Percival</a> can be written as</p><p class="math-container">\[  \left\{\begin{array}{l}
  ∂_tη+∂_x\big( h u\big)=0,\\[1ex]
  ∂_tv+∂_x\big(η+\tfrac{ϵ}{2}v^2+\tfrac{μϵ}{6h^2} (∂_x(hu))^2\big) =0,
  \end{array}\right.\]</p><p>where <span>$h=1 + ϵ η$</span> is the depth, <span>$v=∂_xψ$</span> the derivative of the trace of the velocity potential at the surface, and <span>$u$</span> is obtained by solving the elliptic problem</p><p class="math-container">\[ u -\tfrac{μ}{3}∂_x( h^{-1} ∂_x(hu)) = v.\]</p><p>The associated code is <a href="../library/#WaterWaves1D.SquareRootDepth"><code>SquareRootDepth</code></a>.</p><h4 id="The-&quot;non-hydrostatic&quot;-system"><a class="docs-heading-anchor" href="#The-&quot;non-hydrostatic&quot;-system">The &quot;non-hydrostatic&quot; system</a><a id="The-&quot;non-hydrostatic&quot;-system-1"></a><a class="docs-heading-anchor-permalink" href="#The-&quot;non-hydrostatic&quot;-system" title="Permalink"></a></h4><p>The &quot;non-hydrostatic&quot; system proposed by <a href="https://doi.org/10.3934/dcdsb.2015.20.961">Bristeau, Mangeney, Sainte-Marie and Seguin</a> can be written as</p><p class="math-container">\[  \left\{\begin{array}{l}
  ∂_tη+∂_x\big( h u\big)=0,\\[1ex]
  ∂_tv+∂_x\big(η+\tfrac{ϵ}{2}v^2+\tfrac{μϵ}{2} ( w∂_x^2(hu) + ∂_x^2( hu w ) + ϵ (∂_xη)(∂_xw)u )\big) =0,
  \end{array}\right.\]</p><p>where <span>$h=1 + ϵ η$</span> is the depth, <span>$v=∂_xψ$</span> the derivative of the trace of the velocity potential at the surface, <span>$w=-(h ∂ₓu)/2$</span> and <span>$u$</span> is obtained by solving the elliptic problem</p><p class="math-container">\[ hu -\tfrac{μ}{4}∂_x( h^3 ∂_xu) = hv.\]</p><p>The associated code is <a href="../library/#WaterWaves1D.NonHydrostatic"><code>NonHydrostatic</code></a>.</p><h4 id="The-Whitham-Green-Naghdi-system"><a class="docs-heading-anchor" href="#The-Whitham-Green-Naghdi-system">The Whitham-Green-Naghdi system</a><a id="The-Whitham-Green-Naghdi-system-1"></a><a class="docs-heading-anchor-permalink" href="#The-Whitham-Green-Naghdi-system" title="Permalink"></a></h4><p>The Whitham-Green-Naghdi system proposed by <a href="https://doi.org/10.1137/130947064">Duchêne, Israwi and Talhouk</a>. can be viewed as a modified Green-Naghdi system in view of fully recovering the <a href="https://en.wikipedia.org/wiki/Dispersion_(water_waves)">dispersive properties</a> of the water waves system. In other words, in the linear framework, that is setting <span>$ϵ=0$</span>, the model coincides with the linearized water waves system.</p><p class="math-container">\[  \left\{\begin{array}{l}
  ∂_tη+∂_x\big( h u\big)=0,\\[1ex]
  ∂_tv+∂_x\big(η+ϵ uv - \tfrac{ϵ}{2}u^2-\tfrac{μϵ}2 (h F_0^μ∂_xu)^2\big) =0,
  \end{array}\right.\]</p><p>where <span>$h=1 + ϵ η$</span> is the depth, <span>$v=∂_xψ$</span> the derivative of the trace of the velocity potential at the surface, and <span>$u$</span> the layer-averaged horizontal velocity obtained by solving the elliptic problem</p><p class="math-container">\[hu -\tfrac{μ}{3}F_0^μ∂_x( h^3 F_0^μ∂_xu) = hv.\]</p><p>with <span>$F_0^μ=\sqrt{3((F_1^μ)^{-1}(D) - 1)}/D$</span> where <span>$F_1^μ=\frac{\tanh(\sqrtμ D)}{\sqrtμ D}$</span> (here we use the notation <span>$F(D)$</span> for the <a href="https://en.wikipedia.org/wiki/Multiplier_(Fourier_analysis)">action</a> of pointwise multiplying by the function <span>$F$</span> in the Fourier space).</p><p>The associated code is <a href="../library/#WaterWaves1D.WhithamBoussinesq"><code>WhithamBoussinesq</code></a>.</p><h4 id="The-Isobe-Kakinuma-systems"><a class="docs-heading-anchor" href="#The-Isobe-Kakinuma-systems">The Isobe-Kakinuma systems</a><a id="The-Isobe-Kakinuma-systems-1"></a><a class="docs-heading-anchor-permalink" href="#The-Isobe-Kakinuma-systems" title="Permalink"></a></h4><p>The Isobe-Kakinuma model is a hierarchy of models proposed by <a href="https://doi.org/10.1061/9780784400890.023">Isobe</a>, depending on the rank <span>$N$</span> and the parameters <span>$(p_0,p_1,⋯,p_N)$</span></p><p class="math-container">\[  \left\{\begin{array}{l}
  ∂_tη+∂_x\left( \sum_{j=0}^N\tfrac{h^{p_j+1}}{p_j+1}∂_xϕ_j \right)=0,\\[1ex]
  ∂_tv+∂_x\left( η
  +ϵ \left( \sum_{i=0}^Np_ih^{p_i-1}ϕ_i \right)∂_x\left( \sum_{j=0}^N\tfrac{h^{p_j+1}}{p_j+1}∂_xϕ_j \right)
  +\tfrac{ϵ}{2}\left( \sum_{j=0}^Nh^{p_j}∂_xϕ_j\right)^2
  +\tfrac{ϵ}{2μ} \left( \sum_{j=0}^Np_jh^{p_j-1}ϕ_j\right)^2 \right) =0,
  \end{array}\right.\]</p><p>where <span>$h=1 + ϵ η$</span> is the depth, <span>$v=∂_xψ$</span> the derivative of the trace of the velocity potential at the surface, and <span>$(ϕ₀,ϕ₁,⋯,ϕ_N)$</span> are obtained by solving the elliptic problem</p><p class="math-container">\[  \left\{\begin{array}{l}
\sum_{j=0}^Nh^{p_j}ϕ_j =ψ,\\[1ex]
-h^{p_i} ∂_x\left(\sum_{j=0}^N\tfrac{h^{p_j+1}}{p_j+1}∂_xϕ_j \right)
+ ∂_x\left(\sum_{j=0}^N\tfrac{h^{p_i+p_j+1}}{p_i+p_j+1}∂_xϕ_j \right)
-\tfrac{1}{μ} \sum_{j=0}^N \tfrac{p_ip_j}{p_i+p_j+1}ϕ_j=0 \quad (\forall i∈\{1,⋯,N\})
  \end{array}\right.\]</p><p>The associated code <a href="../library/#WaterWaves1D.IsobeKakinuma"><code>IsobeKakinuma</code></a> is (for now) limited to the case <span>$N=1$</span> and <span>$(p₀,p₁)=(0,2)$</span>.</p><h3 id="Small-steepness-models"><a class="docs-heading-anchor" href="#Small-steepness-models">Small steepness models</a><a id="Small-steepness-models-1"></a><a class="docs-heading-anchor-permalink" href="#Small-steepness-models" title="Permalink"></a></h3><p>Small-steepness models rely on the smallness of the steepness dimensionless parameter, <span>$ϵ\sqrt{μ}≪1$</span>, and may be valid in shallow water as well as deep water configurations.</p><p>In what follows we use the notation <span>$F(D)$</span> for the <a href="https://en.wikipedia.org/wiki/Multiplier_(Fourier_analysis)">action</a> of pointwise multiplying by the function <span>$F$</span> in the Fourier space. Specifically,</p><p class="math-container">\[T^μ=-{\rm i}\tanh(\sqrtμ D)\]</p><p>is the &quot;Tilbert transform&quot; (related to the <a href="https://en.wikipedia.org/wiki/Hilbert_transform#Relationship_with_the_Fourier_transform">Hilbert transform</a>, the latter arising in the infinite layer configuration, <span>$μ=∞$</span>).</p><h4 id="The-Airy-equations"><a class="docs-heading-anchor" href="#The-Airy-equations">The Airy equations</a><a id="The-Airy-equations-1"></a><a class="docs-heading-anchor-permalink" href="#The-Airy-equations" title="Permalink"></a></h4><p>The simplest small-steepness model is the linear <a href="https://en.wikipedia.org/wiki/Airy_wave_theory">Airy</a> water waves obtained by setting <span>$ϵ=0$</span> in the water waves system:</p><p class="math-container">\[  \left\{\begin{array}{l}
  ∂_tη-\tfrac{1}{\sqrtμ ν} T^μv =0,\\[1ex]
  ∂_tv+∂_xη=0,
  \end{array}\right.\]</p><p>where we denote <span>$v=∂_xψ$</span> the derivative of the trace of the velocity potential at the surface.</p><p>The associated code is <a href="../library/#WaterWaves1D.Airy"><code>Airy</code></a>.</p><h4 id="The-spectral-systems"><a class="docs-heading-anchor" href="#The-spectral-systems">The spectral systems</a><a id="The-spectral-systems-1"></a><a class="docs-heading-anchor-permalink" href="#The-spectral-systems" title="Permalink"></a></h4><p><a href="https://doi.org/10.1017/s002211208700288x">Dommermuth and Yue</a>, <a href="https://doi.org/10.1029/jc092ic11p11803">West et al.</a>, and <a href="https://doi.org/10.1006/jcph.1993.1164">Craig and Sulem</a> have proposed a hierarchy of systems based on a &quot;spectral&quot; expansion, which can be interpreted through the Taylor expansion of the Dirichlet-to-Neumann, <span>$G^μ[ϵη]ψ$</span>, with respect to the surface deformation variable:</p><p class="math-container">\[G^μ[ϵη]ψ=G^μ[0]ψ + ϵ (D_η G^μ[0])(ϵη)ψ + ϵ^2 (D_η^2 G^μ[0])(ϵη,ϵη)ψ + ⋯\]</p><p>The first nonlinear system of the hierarchy, incorporating only quadratic nonlinearities, is</p><p class="math-container">\[  \left\{\begin{array}{l}
  ∂_tη-\tfrac{1}{\sqrtμ ν} T^μv  + \tfrac{ϵ}{ν} ∂_x\big(η v +  T^μ(η T^μ v)\big) =0,\\[1ex]
  ∂_tv+∂_xη+\frac{ϵ}{2ν}∂_x\big( v^2-(T^μv)^2\big)=0,
  \end{array}\right.\]</p><p>where we denote <span>$v=∂_xψ$</span> the derivative of the trace of the velocity potential at the surface.</p><p>Higher order systems can be constructed using recursive formula. Explicit expressions up to quintic nonlinearities are given in <a href="http://hdl.handle.net/2433/251940">Choi</a>.</p><p>The associated code is <a href="../library/#WaterWaves1D.WWn"><code>WWn</code></a>.</p><h4 id="The-rectified-spectral-systems"><a class="docs-heading-anchor" href="#The-rectified-spectral-systems">The rectified spectral systems</a><a id="The-rectified-spectral-systems-1"></a><a class="docs-heading-anchor-permalink" href="#The-rectified-spectral-systems" title="Permalink"></a></h4><p>It turns out the spectral models above suffer from spurious instabilities; see <a href="https://doi.org/10.1098/rspa.2013.0849">Ambrose, Bona and Nicholls</a>.</p><p><a href="https://arxiv.org/abs/2203.03277">Duchêne and Melinand</a> proposed a &quot;rectified&quot; quadratic model:</p><p class="math-container">\[  \left\{\begin{array}{l}
  ∂_tη-\tfrac{1}{\sqrtμ ν} T^μv  + \tfrac{ϵ}{ν} ∂_x\big((J^δη) v +  T^μ((J^δη) T^μ v)\big) =0,\\[1ex]
  ∂_tv+∂_xη+\frac{ϵ}{2ν}∂_xJ^δ\big( v^2-(T^μv)^2\big)=0,
  \end{array}\right.\]</p><p>with <span>$J^δ=J_0(δD)$</span> where <span>$J_0(k)$</span> approaches <span>$1$</span> for small wavenumbers, <span>$k$</span>, and approaches <span>$0$</span> for large wavenumbers; and the parameter <span>$δ$</span> can be freely chosen, but is typically of the size of <span>$\tfrac{ϵ}{ν}$</span>. In the associated code, <a href="../library/#WaterWaves1D.WWn"><code>WWn</code></a>, one has by default</p><p class="math-container">\[J_0(k)=\min(1,1/|k|).\]</p><h4 id="The-Matsuno-system"><a class="docs-heading-anchor" href="#The-Matsuno-system">The Matsuno system</a><a id="The-Matsuno-system-1"></a><a class="docs-heading-anchor-permalink" href="#The-Matsuno-system" title="Permalink"></a></h4><p>The model introduced by <a href="https://doi.org/10.1103/PhysRevLett.69.609">Matsuno</a> is</p><p class="math-container">\[  \left\{\begin{array}{l}
  ∂_tη-\tfrac{1}{\sqrtμ ν} T^μu  + \tfrac{ϵ}{ν} ∂_x(η u) +  \tfrac{ϵ}{ν} T^μ(η ∂_x T^μ u) =0,\\[1ex]
  ∂_tu+\big(1-ϵ\sqrtμ T^μ∂_xη\big)∂_xη+\frac{ϵ}{2ν}∂_x\big( u^2\big)=0,
  \end{array}\right.\]</p><p>where <span>$u=∂_xψ-ϵ\sqrtμ(T^μ∂_xψ)(∂_xη)$</span> represents the horizontal velocity at the free surface.</p><p>The associated codes are <a href="../library/#WaterWaves1D.Matsuno"><code>Matsuno</code></a>, and <a href="../library/#WaterWaves1D.Matsuno_fast"><code>Matsuno_fast</code></a> for a less human-readable but more efficient version.</p><h4 id="The-modified-Matsuno-system"><a class="docs-heading-anchor" href="#The-modified-Matsuno-system">The modified Matsuno system</a><a id="The-modified-Matsuno-system-1"></a><a class="docs-heading-anchor-permalink" href="#The-modified-Matsuno-system" title="Permalink"></a></h4><p>In view of ensuring the stability of the equations, <a href="https://arxiv.org/abs/2203.03277">Duchêne and Melinand</a> proposed a modified Matsuno system:</p><p class="math-container">\[  \left\{\begin{array}{l}
  ∂_tη-\tfrac{1}{\sqrtμ ν} T^μu  + \tfrac{ϵ}{ν} ∂_x(η u) +  \tfrac{ϵ}{ν} T^μ(η ∂_x T^μ u) =0,\\[1ex]
  ∂_tu+\exp\big(-ϵ\sqrtμ T^μ∂_xη\big)∂_xη+\frac{ϵ}{2ν}∂_x\big( u^2\big)=0.
  \end{array}\right.\]</p><p>The associated codes is <a href="../library/#WaterWaves1D.modifiedMatsuno"><code>modifiedMatsuno</code></a>.</p><h4 id="The-Akers-Nicholls-system"><a class="docs-heading-anchor" href="#The-Akers-Nicholls-system">The Akers-Nicholls system</a><a id="The-Akers-Nicholls-system-1"></a><a class="docs-heading-anchor-permalink" href="#The-Akers-Nicholls-system" title="Permalink"></a></h4><p>The model introduced in <a href="https://doi.org/10.1137/090771351">Akers and Nicholls</a> (see also <a href="https://doi.org/10.1007/s42286-019-00005-w">Cheng, Granero-Belinchón, Shkoller and Milewski</a>) can be written as</p><p class="math-container">\[  \left\{\begin{array}{l}
  ∂_tη+∂_x m=0,\\[1ex]
  ∂_tm-\tfrac{1}{\sqrtμ ν} T^μ\big(η+\frac{ϵ}{ν}(L^μ m)^2\big)+\frac{ϵ}{ν}\big(η∂_xη+T^μ(η ∂_x T^μ η)\big)=0,
  \end{array}\right.\]</p><p>with notations as above, <span>$L^μ=\frac{ν\sqrtμ D}{\tanh(\sqrtμ D)}$</span> and where <span>$m=-\frac1{\sqrtμ ν} T^μψ  + \frac{ϵ}{ν} \big(η ∂_xψ +  T^μ(η T^μ ∂_xψ)\big)$</span> represents the vertically integrated horizontal momentum.</p><p>The associated codes is <a href="../library/#WaterWaves1D.AkersNicholls"><code>AkersNicholls</code></a>, and <a href="../library/#WaterWaves1D.AkersNicholls_fast"><code>AkersNicholls_fast</code></a> for a less human-readable but more efficient version.</p><h2 id="Mass,-momentum,-energy"><a class="docs-heading-anchor" href="#Mass,-momentum,-energy">Mass, momentum, energy</a><a id="Mass,-momentum,-energy-1"></a><a class="docs-heading-anchor-permalink" href="#Mass,-momentum,-energy" title="Permalink"></a></h2><p>Solutions to the water waves equations preserve along time (among other integrals of motion listed by <a href="https://doi.org/10.1017/S0022112082003292">Benjamin and Olver</a>)</p><ul><li>the excess of mass,</li></ul><p class="math-container">\[\int η(t,x)\, {\rm d}x\ ;\]</p><ul><li>the momentum (or rather the horizontal impulse),</li></ul><p class="math-container">\[\int (η ∂_xψ)(t,x)\, {\rm d}x\ ;\]</p><ul><li>the total energy,</li></ul><p class="math-container">\[\frac12 \int (η^2 + \tfrac{1}{μν} ψ G^μ[ϵη]ψ)(t,x)\, {\rm d}x\ .\]</p><p>Such is also the case for solutions to all models cited above using as velocity variable <span>$v=∂_xψ$</span> (with analogous formula).</p><p>The numerical discretization of these preserved quantities, coded in <a href="../library/#WaterWaves1D.mass-Tuple{Problem}"><code>mass</code></a>, <a href="../library/#WaterWaves1D.momentum-Tuple{Problem}"><code>momentum</code></a>, <a href="../library/#WaterWaves1D.energy-Tuple{Problem}"><code>energy</code></a> (and <a href="../library/#WaterWaves1D.massdiff-Tuple{Problem}"><code>massdiff</code></a>, <a href="../library/#WaterWaves1D.momentumdiff-Tuple{Problem}"><code>momentumdiff</code></a>, <a href="../library/#WaterWaves1D.energydiff-Tuple{Problem}"><code>energydiff</code></a>) provide valuable insights at the precision of a computed numerical solution.</p><h2 id="Pseudospectral-methods"><a class="docs-heading-anchor" href="#Pseudospectral-methods">Pseudospectral methods</a><a id="Pseudospectral-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Pseudospectral-methods" title="Permalink"></a></h2><p>Although this is not imperative of the package, all the codes mentioned above use Fourier-based pseudospectral methods for spatial discretization. This method is particularly suitable for data which are either periodic or decaying at infinity (in which case the function at stake is considered as periodic on a sufficiently large period), and fairly regular. In this framework one approaches <span>$2L$</span>-periodic functions by <em>finite</em> Fourier sums of the form (assuming <span>$N$</span> even)</p><p class="math-container">\[u(t,x)≈\sum_{k=-N/2}^{N/2-1} a_k(t) e^{{\rm i} \tfrac{π}{L}k x},\]</p><p>and seek a system of ordinary differential equations on the coefficients <span>$a_k(t)$</span> (which are then discretized in time by your favorite time solver).</p><p>In practice, given the values <span>$(u(x_j))_{j∈\{0,⋯,N-1\}}$</span> at the regularly spaced <em>collocation points</em> <span>$x_j= -L+2j\tfrac{L}{N}$</span>, one uses the discrete Fourier transform (computed efficiently with a <a href="https://en.wikipedia.org/wiki/Fast_Fourier_transform">Fast Fourier transform</a> (FFT)) to deduce the corresponding coefficients <span>$a_k$</span>. Hence the coefficients are related to the coefficients of the (infinite) Fourier series</p><p class="math-container">\[u(t,x)=\sum_{k=-∞}^{∞} c_k(t) e^{{\rm i} \tfrac{π}{L}k x}\]</p><p>through the relation</p><p class="math-container">\[a_k(t) = \sum_{ℓ\in\mathbb{Z}} c_{k+ℓN}(t).\]</p><p>Hence each of the coefficients <span>$a_k$</span> encompasses a full series of Fourier coefficients, which is unavoidable since <span>$e^{{\rm i} \tfrac{π}{L}k x}$</span> and <span>$e^{{\rm i} \tfrac{π}{L}(k+ℓN) x}$</span> are indistinguishable on the gridpoints <span>$x∈\{x_0,⋯,x_{N-1}\}$</span>: this is called <a href="https://en.wikipedia.org/wiki/Aliasing"><em>aliasing</em></a>. Yet for smooth functions, Fourier coefficients rapidly decrease, and the error between the finite spectral decomposition and the infinite Fourier decomposition can often be made immaterial (that is to the order of machine precision rounding errors) when choosing a sufficient large number of modes, <span>$N$</span>.</p><p>When using the finite spectral decomposition, the action of <a href="https://en.wikipedia.org/wiki/Multiplier_(Fourier_analysis)">Fourier multipliers</a>, and in particular spatial differentiation, is performed <em>exactly</em> (that is up to machine precision rounding errors) through corresponding multiplication on the discrete coefficients <span>$a_k$</span>, and only nonlinear contributions require some attention. The simplest way to approximately compute products (or any pointwise operations in the space variable) is by performing pointwise operations on values at collocation points which are obtained from the discrete coefficients using discrete inverse Fourier transform. For the sake of discussion, consider</p><p class="math-container">\[ u^2(x_j,t) ≈ \big(\sum_{k=-N/2}^{N/2-1} a_k(t) e^{{\rm i} \tfrac{π}{L}k x_j}\big)^2
 = \sum_{m=-N/2}^{N/2-1}\sum_{n=-N/2}^{N/2-1} a_m a_n e^{{\rm i} \tfrac{π}{L}(m+n) x_j}.\]</p><p>One infers</p><p class="math-container">\[u^2(x_j,t) ≈ \sum_{k=-N/2}^{N/2-1} b_k(t) e^{{\rm i} \tfrac{π}{L}k x_j}, \qquad b_k = \sum_{m+n\in \{k-N,k,k+N\}}a_m a_n.\]</p><p>In the above formula for <span>$b_k$</span>, some of the summands are spurious effects from aliasing, which sometimes contribute to numerical instabilities. In order to suppress such terms the so-called <em>dealiasing</em> consists in adding a sufficient number of modes with coefficients set to zero (in practice one often uses ideal low-pass filters, that is set to zero extreme modes, so as to always work with vectors with a fixed given length). The so-called <a href="https://doi.org/10.1175/1520-0469(1971)028&lt;1074:oteoai&gt;2.0.co;2">Orszag</a>&#39;s <code>3/2</code> rule states that, in the presence of quadratic nonlinearities, padding <code>3/2</code> modes (or zero-ing <code>1/3</code> modes) is sufficient to discard all spurious aliasing contributions, and provides in particular a <a href="https://en.wikipedia.org/wiki/Galerkin_method">Galerkin</a> approximation since the error is orthogonal to all expansion functions.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../problems/">Problems »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Friday 14 March 2025 12:57">Friday 14 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
